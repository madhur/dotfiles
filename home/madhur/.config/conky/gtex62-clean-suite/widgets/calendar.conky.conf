--[[
  ~/.config/conky/gtex62-clean-suite/widgets/calendar.conky.conf
  Monthly calendar widget

  • Uses theme.lua for all sizing + fonts (cal_* keys).
  • Delegates drawing to lua/calendar.lua via lua_draw_hook_pre.
  • Width/height are derived from theme cell sizes so layout stays in sync.
]]

local theme      = dofile((os.getenv("HOME") or "") .. "/.config/conky/gtex62-clean-suite/theme.lua")

-- Derived width/height from cells (7x6 grid + title/header). Keep in sync with calendar.lua defaults or your theme.
local cell_w     = theme.cal_cell_w or 44
local cell_h     = theme.cal_cell_h or 26
local col_gap    = theme.cal_col_gap or 2
local row_gap    = theme.cal_row_gap or 2
local title_h    = theme.cal_title_h or ((theme.cal_title_size or 14) + 6)
local header_h   = theme.cal_header_h or ((theme.cal_weekday_size or 10) + 6)
local cols, rows = 7, 6

-- Derived calendar box size (title + weekday header + 7x6 day grid)
local grid_w     = cols * cell_w + (cols - 1) * col_gap
local grid_h     = rows * cell_h + (rows - 1) * row_gap
local cal_w      = grid_w
local cal_h      = title_h + header_h + grid_h

conky.config     = {
  alignment              = 'top_left',
  background             = false,
  double_buffer          = true,
  update_interval        = 1,

  use_xft                = true,
  font                   = theme.font or 'DejaVu Sans Mono:size=10',

  own_window             = true,
  own_window_type        = 'override',
  own_window_hints       = 'undecorated,sticky,skip_taskbar,skip_pager,below',
  own_window_argb_visual = true,
  own_window_argb_value  = 0,
  own_window_transparent = true,
  own_window_class       = 'Conky',

  -- place it where you like
  gap_x                  = theme.cal_gap_x or 5200,
  gap_y                  = theme.cal_gap_y or 30,

  default_color          = theme.default_color or 'FFFFFF',
  color1                 = theme.color1 or 'A0A0A0',

  minimum_width          = cal_w,
  minimum_height         = cal_h,

  lua_load               = os.getenv("HOME") .. '/.config/conky/gtex62-clean-suite/lua/calendar.lua',

  lua_draw_hook_pre      = 'draw_calendar',
}

conky.text       = [[
]]
