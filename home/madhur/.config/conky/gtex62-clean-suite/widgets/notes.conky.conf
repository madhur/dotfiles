--[[
  ~/.config/conky/gtex62-clean-suite/widgets/notes.conky.conf
  Scrolling "sticky notes" widget

  • Uses theme.lua for notes-specific knobs (font_notes, notes_wrap, notes_lines).
  • Reads from ~/Documents/conky-notes.txt and displays the first N wrapped lines.
  • fold(1) and sed(1) do the wrapping + line limiting.
]]
-- Uses shared theme.lua for fonts/colors/layout (with note-specific fallbacks)
local theme         = dofile(os.getenv("HOME") .. "/.config/conky/gtex62-clean-suite/theme.lua")

-- Optional per-notes overrides (use fallbacks if not present)
local font_notes    = theme.font_notes or theme.font or 'DejaVu Sans Mono:size=10'
local color_default = theme.default_color or 'FFFFFF'
local color_label   = theme.color1 or 'A0A0A0'
local goto_col      = theme.goto_col or 110

-- Notes layout knobs (can be set in theme.lua)
local notes_wrap    = theme.notes_wrap or 39    -- chars per line for fold
local notes_lines   = theme.notes_lines or 90   -- how many lines to show
local notes_line_px = theme.notes_line_px or 14 -- approx px per line (mono font)
local min_height_px = notes_lines * notes_line_px

conky.config        = {
  alignment              = 'top_left',
  background             = false,
  double_buffer          = true,
  update_interval        = 1,

  use_xft                = true,
  font                   = font_notes,

  own_window             = true,
  own_window_type        = 'desktop', -- was 'dock'
  own_window_hints       = 'undecorated,sticky,skip_taskbar,skip_pager,below',
  own_window_argb_visual = true,
  own_window_argb_value  = 0,
  own_window_transparent = true,
  own_window_class       = 'Conky',
  -- optional but nice:
  -- own_window_title = 'conky-<name>',  -- e.g., conky-net, conky-notes


  minimum_width    = 310,
  maximum_width    = 310,
  minimum_height   = min_height_px, -- derived from notes_lines * notes_line_px
  text_buffer_size = 24576,

  -- keep your placement
  gap_x            = 5190,
  gap_y            = 240,

  draw_shades      = false,
  draw_borders     = false,
  default_color    = color_default,
  color1           = color_label,

  -- value column helper (not strictly needed here but included for consistency)
  template0        = string.format("${goto %d}", goto_col),
}

-- Reads the first N wrapped lines from your notes file:
--   $HOME/Documents/conky-notes.txt
conky.text          = [[
${execi 3 sh -c 'fold -s -w ]] ..
    notes_wrap .. [[ "$HOME/Documents/conky-notes.txt" | sed -n "1,]] .. notes_lines .. [[p"'}
]]
